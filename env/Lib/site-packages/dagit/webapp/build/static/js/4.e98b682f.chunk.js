"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[4],{77523:function(e,n,t){t.d(n,{C:function(){return h}});var r=t(19065),o=t(8358),i=t(32030),s=t(75453),a=t(75497),l=t(325),c=t(93141),d=t(76336),u=t(32289),h=function(){var e=l.useContext(d.C5),n=e.allRepos,t=e.visibleRepos,h=e.toggleVisible,p=l.useState(!1),f=(0,r.Z)(p,2),x=f[0],m=f[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(o.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:x,style:{width:"auto"},onClose:function(){return m(!1)},children:[(0,u.jsx)(o.fK,{icon:"repo",label:"Filter code locations"}),(0,u.jsx)(c.e,{options:n,onBrowse:function(){return m(!1)},onToggle:h,selected:t}),(0,u.jsx)(o.cN,{children:(0,u.jsx)(i.x,{padding:{top:8},children:(0,u.jsx)(s.zx,{intent:"none",onClick:function(){return m(!1)},children:"Done"})})})]}),(0,u.jsx)(s.zx,{intent:"none",icon:(0,u.jsx)(a.JO,{name:"folder"}),rightIcon:(0,u.jsx)(a.JO,{name:"expand_more"}),onClick:function(){return m(!0)},children:"".concat(t.length," of ").concat(n.length)})]})}},6556:function(e,n,t){t.r(n),t.d(n,{OverviewRoot:function(){return Hn},default:function(){return Xn}});var r,o,i,s=t(325),a=t(27601),l=t(99500),c=t(95764),d=t(73701),u=t(3159),h=t(30804),p=t(31112),f=t(12745),x=t(32030),m=t(89646),g=t(47387),j=t(79082),v=t(12436),y=t(47678),w=t(78093),b=t(82348),k=t(31269),S=t(37286),C=t(32289),E=function(e){var n=e.refreshState,t=e.tab;return(0,C.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,C.jsxs)(k.mQ,{selectedTabId:t,children:[(0,C.jsx)(S.f,{id:"timeline",title:"Timeline",to:"/overview/timeline"}),(0,C.jsx)(S.f,{id:"jobs",title:"Jobs",to:"/overview/jobs"}),(0,C.jsx)(S.f,{id:"schedules",title:"Schedules",to:"/overview/schedules"}),(0,C.jsx)(S.f,{id:"sensors",title:"Sensors",to:"/overview/sensors"}),(0,C.jsx)(S.f,{id:"resources",title:"Resources",to:"/overview/resources"}),(0,C.jsx)(S.f,{id:"backfills",title:"Backfills",to:"/overview/backfills"})]}),n?(0,C.jsx)(x.x,{padding:{bottom:8},children:(0,C.jsx)(y.xi,{refreshState:n})}):null]})},T=t(79253),A=t(77892),O=t(50741),N=t(76450),I=t(78042),L=function(){(0,w.Px)(),(0,b.j)("Overview | Backfills");var e=(0,d.a)(P),n=(0,A.l)({query:R,variables:{},pageSize:10,nextCursorForResult:function(e){var n;return"PartitionBackfills"===e.partitionBackfillsOrError.__typename?null===(n=e.partitionBackfillsOrError.results[9])||void 0===n?void 0:n.id:void 0},getResultArray:function(e){return"PartitionBackfills"===(null===e||void 0===e?void 0:e.partitionBackfillsOrError.__typename)?e.partitionBackfillsOrError.results:[]}}),t=n.queryResult,r=n.paginationProps,o=(0,y.C4)(t,y.dT);return(0,C.jsxs)(h.T,{children:[(0,C.jsx)(p.m,{title:(0,C.jsx)(f.X6,{children:"Overview"}),tabs:(0,C.jsx)(E,{tab:"backfills",refreshState:o})}),(0,C.jsx)(O.g,{queryResult:t,allowStaleData:!0,children:function(n){var o,i=n.partitionBackfillsOrError;if("PythonError"===i.__typename)return(0,C.jsx)(v.T,{error:i});if(!i.results.length)return(0,C.jsx)(x.x,{padding:{vertical:64},children:(0,C.jsx)(m.t,{icon:"no-results",title:"No backfills found",description:(0,C.jsx)("p",{children:"This instance does not have any backfill jobs."})})});var s=((null===(o=e.data)||void 0===o?void 0:o.instance.daemonHealth.allDaemonStatuses)||[]).filter((function(e){return"BACKFILL"===e.daemonType})).map((function(e){return e.required&&e.healthy})),a=s.length&&s.every((function(e){return e}));return(0,C.jsxs)("div",{children:[a?null:(0,C.jsx)(x.x,{padding:{horizontal:24,vertical:16},children:(0,C.jsx)(T.B1,{})}),(0,C.jsx)(N.G,{backfills:i.results.slice(0,10),refetch:t.refetch}),i.results.length>0?(0,C.jsx)("div",{style:{marginTop:"16px"},children:(0,C.jsx)(g.b$,(0,c.Z)({},r))}):null]})}})]})},P=(0,u.Ps)(r||(r=(0,l.Z)(["\n  query InstanceHealthForBackfillsQuery {\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n"])),I.O),R=(0,u.Ps)(o||(o=(0,l.Z)(["\n  query InstanceBackfillsQuery($cursor: String, $limit: Int) {\n    partitionBackfillsOrError(cursor: $cursor, limit: $limit) {\n      ... on PartitionBackfills {\n        results {\n          id\n          status\n          isValidSerialization\n          numPartitions\n          timestamp\n          partitionSetName\n          partitionSet {\n            id\n            name\n            mode\n            pipelineName\n            repositoryOrigin {\n              id\n              repositoryName\n              repositoryLocationName\n            }\n          }\n          error {\n            ...PythonErrorFragment\n          }\n\n          ...BackfillTableFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),j.B,N.b),F=t(19065),z=t(922),Z=t(34595),_=t(55113),U=t(7838),B=t(54268),D=t(60652),q=t(8358),V=t(75453),M=t(13008),W=t.n(M),$=t(55386),G=t.n($),K=t(93975),J=t.n(K),Q=t(74549),H=t(55419),X=t(77171),Y=t(69305),ee=t(58),ne=t(45302),te=t(1520),re=t(25298);W().extend(G()),W().extend(J());var oe=function(){var e=(0,a.UO)().backfillId;(0,w.Px)(),(0,b.j)("Backfill | ".concat(e));var n=(0,d.a)(je,{variables:{backfillId:e}}),t=n.data,r=null===t||void 0===t?void 0:t.partitionBackfillOrError,o=!0;r&&"PartitionBackfill"===r.__typename&&(o=r.status===Y.Jv3.REQUESTED);var i=(0,y.C4)(n,1e4,o);return(0,C.jsxs)(h.T,{children:[(0,C.jsx)(p.m,{title:(0,C.jsxs)("div",{style:{fontSize:"18px"},children:[(0,C.jsx)(Q.rU,{to:"/overview/backfills",style:{color:U.w.Gray700},children:"Backfills"})," / ",e]}),right:o?(0,C.jsx)(y.xi,{refreshState:i}):null}),function(){var n,o,i;if(!r||!t)return(0,C.jsx)(x.x,{padding:64,"data-testid":(0,te.N)("page-loading-indicator"),children:(0,C.jsx)(Z.$,{purpose:"page"})});if("PythonError"===r.__typename)return(0,C.jsx)(v.T,{error:r});function s(n){var t=[{token:"tag",value:"dagster/backfill=".concat(e)}];switch(n){case"requested":t.push({token:"status",value:Y.VOA.STARTED},{token:"status",value:Y.VOA.QUEUED},{token:"status",value:Y.VOA.STARTING});break;case"complete":t.push({token:"status",value:Y.VOA.SUCCESS});break;case"failed":t.push({token:"status",value:Y.VOA.FAILURE}),t.push({token:"status",value:Y.VOA.CANCELED})}return(0,ne.it)(t)}return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(x.x,{padding:24,flex:{direction:"row",justifyContent:"space-between",wrap:"nowrap",alignItems:"center"},children:[(0,C.jsx)(ie,{label:"Created",detail:(0,C.jsx)(H.E,{timestamp:{ms:Number(1e3*r.timestamp)},timeFormat:{showSeconds:!0,showTimezone:!1}})}),(0,C.jsx)(ie,{label:"Duration",detail:(0,C.jsx)(ge,{start:1e3*r.timestamp,end:r.endTimestamp?1e3*r.endTimestamp:null})}),(0,C.jsx)(ie,{label:"Partition Selection",detail:(0,C.jsx)(ve,{numPartitions:r.numPartitions||0,rootAssetTargetedPartitions:null===(n=r.assetBackfillData)||void 0===n?void 0:n.rootAssetTargetedPartitions,rootAssetTargetedRanges:null===(o=r.assetBackfillData)||void 0===o?void 0:o.rootAssetTargetedRanges})}),(0,C.jsx)(ie,{label:"Status",detail:(0,C.jsx)(se,{status:r.status})})]}),(0,C.jsxs)(_.i,{children:[(0,C.jsx)("thead",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{style:{width:"50%"},children:"Asset name"}),(0,C.jsx)("th",{children:(0,C.jsx)("a",{href:s("targeted"),children:"Partitions targeted"})}),(0,C.jsx)("th",{children:(0,C.jsx)("a",{href:s("requested"),children:"Requested"})}),(0,C.jsx)("th",{children:(0,C.jsx)("a",{href:s("complete"),children:"Completed"})}),(0,C.jsx)("th",{children:(0,C.jsx)("a",{href:s("failed"),children:"Failed"})})]})}),(0,C.jsx)("tbody",{children:null===(i=r.assetBackfillData)||void 0===i?void 0:i.assetPartitionsStatusCounts.map((function(e){return(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:(0,C.jsxs)(x.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,C.jsx)("div",{children:(0,C.jsx)("a",{href:(0,X.p)(e.assetKey),children:e.assetKey.path.join("/")})}),(0,C.jsx)("div",{children:(0,C.jsx)(ae,{targeted:e.numPartitionsTargeted,requested:e.numPartitionsRequested,completed:e.numPartitionsCompleted,failed:e.numPartitionsFailed})})]})}),(0,C.jsx)("td",{children:e.numPartitionsTargeted}),(0,C.jsx)("td",{children:e.numPartitionsRequested}),(0,C.jsx)("td",{children:e.numPartitionsCompleted}),(0,C.jsx)("td",{children:e.numPartitionsFailed})]},e.assetKey.path.join("/"))}))})]})]})}()]})},ie=function(e){var n=e.label,t=e.detail;return(0,C.jsxs)(x.x,{flex:{direction:"column",gap:4},style:{minWidth:"280px"},children:[(0,C.jsx)(me,{children:n}),(0,C.jsx)("div",{children:t})]})},se=function(e){switch(e.status){case Y.Jv3.CANCELED:return(0,C.jsx)(B.V,{intent:"warning",children:"Canceled"});case Y.Jv3.COMPLETED:return(0,C.jsx)(B.V,{intent:"success",children:"Completed"});case Y.Jv3.FAILED:return(0,C.jsx)(B.V,{intent:"danger",children:"Failed"});case Y.Jv3.REQUESTED:return(0,C.jsx)(B.V,{intent:"primary",icon:"spinner",children:"Requested"});default:return(0,C.jsx)(B.V,{intent:"warning",children:"Incomplete"})}};function ae(e){var n=e.targeted,t=e.requested,r=e.completed,o=e.failed;return(0,C.jsxs)("div",{style:{borderRadius:"8px",backgroundColor:U.w.Gray100,display:"grid",gridTemplateColumns:"".concat(100*r/n,"% ").concat(100*o/n,"% ").concat(100*t/n,"%"),gridTemplateRows:"100%",height:"12px",width:"200px",overflow:"hidden"},children:[(0,C.jsx)("div",{style:{background:U.w.Green500}}),(0,C.jsx)("div",{style:{background:U.w.Red500}}),(0,C.jsx)("div",{style:{background:U.w.Blue200}})]})}var le,ce,de,ue,he,pe,fe,xe,me=z.ZP.div.withConfig({displayName:"BackfillPage__Label",componentId:"sc-19sdlda-0"})(["color:",";font-size:12px;line-height:16px;"],U.w.Gray700),ge=function(e){var n=e.start,t=e.end,r=s.useReducer((function(e,n){return e+1}),0),o=(0,F.Z)(r,2),i=(o[0],o[1]);s.useEffect((function(){if(!t){var e=setInterval(i,6e4);return function(){return clearInterval(e)}}}),[n,t]);var a=t?t-n:Date.now()-n;return(0,C.jsx)("span",{children:ye(a)})},je=(0,u.Ps)(i||(i=(0,l.Z)(["\n  query BackfillStatusesByAsset($backfillId: String!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ...PartitionBackfillFragment\n      ...PythonErrorFragment\n    }\n  }\n\n  fragment PartitionBackfillFragment on PartitionBackfill {\n    id\n    status\n    timestamp\n    endTimestamp\n    numPartitions\n    assetBackfillData {\n      rootAssetTargetedRanges {\n        start\n        end\n      }\n      rootAssetTargetedPartitions\n      assetPartitionsStatusCounts {\n        assetKey {\n          path\n        }\n        numPartitionsTargeted\n        numPartitionsRequested\n        numPartitionsCompleted\n        numPartitionsFailed\n      }\n    }\n  }\n  ","\n"])),j.B),ve=function(e){var n,t,r=e.numPartitions,o=e.rootAssetTargetedRanges,i=e.rootAssetTargetedPartitions,a=s.useState(!1),l=(0,F.Z)(a,2),c=l[0],d=l[1];if(i)i.length>3?(n=(0,C.jsx)("div",{children:i.map((function(e){return(0,C.jsx)("div",{style:{maxWidth:"100px"},children:(0,C.jsx)(ee.rd,{text:e})},e)}))}),t=(0,C.jsxs)(D.Z,{onClick:function(){d(!0)},children:[re.V.format(r)," partitions"]})):t=(0,C.jsx)(x.x,{flex:{direction:"row",gap:8,wrap:"wrap"},children:i.map((function(e){return(0,C.jsx)("div",{children:e},e)}))});else if(1===(null===o||void 0===o?void 0:o.length)){var u=o[0],h=u.start,p=u.end;t=(0,C.jsxs)("div",{children:[h,"...",p]})}else t=(0,C.jsxs)(D.Z,{onClick:function(){d(!0)},children:[re.V.format(r)," partitions"]}),n=(0,C.jsx)(x.x,{flex:{direction:"column",gap:8},children:null===o||void 0===o?void 0:o.map((function(e){return(0,C.jsxs)("div",{children:[e.start,"...",e.end]},"".concat(e.start,":").concat(e.end))}))});return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{children:t}),(0,C.jsxs)(q.Vq,{isOpen:!!n&&c,title:"Partition selection",children:[(0,C.jsx)(q.a7,{children:n}),(0,C.jsx)(q.cN,{topBorder:!0,children:(0,C.jsx)(V.zx,{onClick:function(){return d(!1)},children:"Close"})})]})]})},ye=function(e){var n=Math.floor(e/1e3%60),t=Math.floor(e/6e4%60),r=Math.floor(e/36e5%24),o=Math.floor(e/864e5),i="";return o>0?(i+="".concat(o,"d "),i+="".concat(r,"h")):r>0?(i+="".concat(r,"h "),i+="".concat(t,"m")):t>0&&(i+="".concat(t,"m "),i+="".concat(n,"s")),i.trim()},we=t(47427),be=t(88863),ke=t(39061),Se=t(44198),Ce=t(77523),Ee=t(76336),Te=t(37099),Ae=t(33902),Oe=t(11831),Ne=t(519),Ie=t(3580),Le=t(65864),Pe=t(71824),Re=t(82426),Fe=t(16279),ze=t(13688),Ze=function(e){var n=e.repos,t=s.useRef(null),r=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Ae.Uz)(n)}))}),[n]),o=(0,Pe.N)(ze.y,r),i=o.expandedKeys,a=o.onToggle,l=o.onToggleAll,c=s.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.jobs;e.push({type:"header",repoAddress:t,jobCount:r.length});var o=(0,Ae.Uz)(t);i.includes(o)&&r.forEach((function(n){var r=n.isJob,o=n.name;e.push({type:"job",repoAddress:t,isJob:r,name:o})}))})),e}),[n,i]),d=(0,Le.w)(n.map((function(e){return e.repoAddress.name}))),u=(0,Ne.useVirtualizer)({count:c.length,getScrollElement:function(){return t.current},estimateSize:function(e){var n=c[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Re.I,{}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:t,children:(0,C.jsx)(Ie.Nh,{$totalHeight:h,children:p.map((function(e){var n=e.index,t=e.key,r=e.size,o=e.start,s=c[n];return"header"===s.type?(0,C.jsx)(Fe.vG,{repoAddress:s.repoAddress,height:r,start:o,onToggle:a,onToggleAll:l,expanded:i.includes((0,Ae.Uz)(s.repoAddress)),showLocation:d.has(s.repoAddress.name),rightElement:(0,C.jsx)(Oe.u,{content:1===s.jobCount?"1 job":"".concat(s.jobCount," jobs"),placement:"top",children:(0,C.jsx)(B.V,{children:s.jobCount})})},t):(0,C.jsx)(Re.b,{name:s.name,isJob:s.isJob,repoAddress:s.repoAddress,height:r,start:o},t)}))})})})]})},_e=t(59019),Ue=function(e){return(0,_e.Z)(e).sort((function(e,n){var t=(0,Ae.Uz)(e.repoAddress),r=(0,Ae.Uz)(n.repoAddress);return t.localeCompare(r)}))},Be=function(e){return new Set(e.map((function(e){return(0,Ae.Uz)((0,Te.kQ)(e.repository.name,e.repositoryLocation.name))})))},De=function(){(0,w.Px)(),(0,b.j)("Overview | Jobs");var e=s.useContext(Ee.C5),n=e.allRepos,t=e.visibleRepos,r=(0,Se.q)({queryKey:"search",defaults:{search:""}}),o=(0,F.Z)(r,2),i=o[0],a=o[1],l=n.length,c=(0,d.a)(Ve,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,g=(0,y.C4)(c,y.dT),j=s.useMemo((function(){var e=Be(t);return qe(u).filter((function(n){var t=n.repoAddress;return e.has((0,Ae.Uz)(t))}))}),[u,t]),v=i.trim().toLocaleLowerCase(),k=v.length>0,S=s.useMemo((function(){var e=v.toLocaleLowerCase();return j.map((function(n){return{repoAddress:n.repoAddress,jobs:n.jobs.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.jobs.length>0}))}),[j,v]);return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(p.m,{title:(0,C.jsx)(f.X6,{children:"Overview"}),tabs:(0,C.jsx)(E,{tab:"jobs",refreshState:g})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[l>1?(0,C.jsx)(Ce.C,{}):null,(0,C.jsx)(be.oi,{icon:"search",value:i,onChange:function(e){return a(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"340px"}})]}),h&&!l?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):function(){if(h&&!u)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading jobs\u2026"})]})});var e=n.length>t.length;return S.length?(0,C.jsx)(Ze,{repos:S}):k?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No matching jobs",description:e?(0,C.jsxs)("div",{children:["No jobs matching ",(0,C.jsx)("strong",{children:i})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No jobs matching ",(0,C.jsx)("strong",{children:i})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No jobs",description:e?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})}()]})},qe=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],o=(0,we.Z)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var s,a=(0,we.Z)(i.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.pipelines,u=(0,Te.kQ)(c,i.name),h=d.filter((function(e){var n=e.name;return!(0,ke.pv)(n)})).map((function(e){return{isJob:e.isJob,name:e.name}}));h.length>0&&r.push({repoAddress:u,jobs:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){o.e(p)}finally{o.f()}return Ue(r)},Ve=(0,u.Ps)(le||(le=(0,l.Z)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"])),j.B),Me=t(85827),We=t(87478),$e=function(e){var n=e.repos,t=s.useRef(null),r=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Ae.Uz)(n)}))}),[n]),o=(0,Pe.N)(ze.y,r),i=o.expandedKeys,a=o.onToggle,l=o.onToggleAll,d=s.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.resources;e.push({type:"header",repoAddress:t,resourceCount:r.length});var o=(0,Ae.Uz)(t);i.includes(o)&&r.forEach((function(n){e.push((0,c.Z)({type:"resource",repoAddress:t},n))}))})),e}),[n,i]),u=(0,Le.w)(n.map((function(e){return e.repoAddress.name}))),h=(0,Ne.useVirtualizer)({count:d.length,getScrollElement:function(){return t.current},estimateSize:function(e){var n=d[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),p=h.getTotalSize(),f=h.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(We.f,{}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:t,children:(0,C.jsx)(Ie.Nh,{$totalHeight:p,children:f.map((function(e){var n=e.index,t=e.key,r=e.size,o=e.start,s=d[n];return"header"===s.type?(0,C.jsx)(Fe.vG,{repoAddress:s.repoAddress,height:r,start:o,onToggle:a,onToggleAll:l,expanded:i.includes((0,Ae.Uz)(s.repoAddress)),showLocation:u.has(s.repoAddress.name),rightElement:(0,C.jsx)(Oe.u,{content:1===s.resourceCount?"1 resource":"".concat(s.resourceCount," resources"),placement:"top",children:(0,C.jsx)(B.V,{children:s.resourceCount})})},t):(0,C.jsx)(We.K,(0,c.Z)({height:r,start:o},s),t)}))})})})]})},Ge=function(){(0,w.Px)(),(0,b.j)("Overview | Resources");var e=s.useContext(Ee.C5),n=e.allRepos,t=e.visibleRepos,r=(0,Se.q)({queryKey:"search",defaults:{search:""}}),o=(0,F.Z)(r,2),i=o[0],a=o[1],l=n.length,c=(0,d.a)(Je,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,g=(0,y.C4)(c,y.dT),j=s.useMemo((function(){var e=Be(t);return Ke(u).filter((function(n){var t=n.repoAddress;return e.has((0,Ae.Uz)(t))}))}),[u,t]),v=i.trim().toLocaleLowerCase(),k=v.length>0,S=s.useMemo((function(){var e=v.toLocaleLowerCase();return j.map((function(n){return{repoAddress:n.repoAddress,resources:n.resources.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.resources.length>0}))}),[j,v]);return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(p.m,{title:(0,C.jsx)(f.X6,{children:"Overview"}),tabs:(0,C.jsx)(E,{tab:"resources",refreshState:g})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[l>1?(0,C.jsx)(Ce.C,{}):null,(0,C.jsx)(be.oi,{icon:"search",value:i,onChange:function(e){return a(e.target.value)},placeholder:"Filter by resource name\u2026",style:{width:"340px"}})]}),h&&!l?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):function(){if(h&&!u)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading resources\u2026"})]})});var e=n.length>t.length;return S.length?(0,C.jsx)($e,{repos:S}):k?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No matching resources",description:e?(0,C.jsxs)("div",{children:["No resources matching ",(0,C.jsx)("strong",{children:i})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No resources matching ",(0,C.jsx)("strong",{children:i})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No resources",description:e?"No resources were found in the selected code locations":"No resources were found in your definitions"})})}()]})},Ke=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],o=(0,we.Z)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var s,a=(0,we.Z)(i.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.allTopLevelResourceDetails,u=(0,Te.kQ)(c,i.name);d.length>0&&r.push({repoAddress:u,resources:d})}}catch(h){a.e(h)}finally{a.f()}}}}catch(h){o.e(h)}finally{o.f()}return Ue(r)},Je=(0,u.Ps)(ce||(ce=(0,l.Z)(["\n  query OverviewResourcesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                allTopLevelResourceDetails {\n                  ...ResourceEntryFragment\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),j.B,Me.L),Qe=t(60736),He=t(45352),Xe=t(85358),Ye=t(95550),en=t.n(Ye),nn=t(49148),tn=t(50346),rn=t(6466),on=t(79540),sn=t(63579),an=t(73565),ln=t(36243),cn=t(88161),dn=t(2097),un=t(62997),hn=function(e){var n=e.sensorStates,t=e.showSubheading,r=void 0===t||t;return n.length?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(x.x,{padding:{vertical:16,horizontal:20},children:[r?(0,C.jsx)(f.pm,{children:"Unloadable sensors"}):null,(0,C.jsx)(fn,{})]}),(0,C.jsxs)(_.i,{children:[(0,C.jsx)("thead",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{style:{maxWidth:"60px"}}),(0,C.jsx)("th",{children:"Sensor name"}),(0,C.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,C.jsx)("th",{children:"Last run"})]})}),(0,C.jsx)("tbody",{children:n.map((function(e){return(0,C.jsx)(mn,{sensorState:e},e.id)}))})]})]}):null},pn=function(e){var n=e.scheduleStates,t=e.showSubheading,r=void 0===t||t;return n.length?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(x.x,{padding:{vertical:16,horizontal:20},children:[r?(0,C.jsx)(f.pm,{children:"Unloadable schedules"}):null,(0,C.jsx)(xn,{})]}),(0,C.jsxs)(_.i,{children:[(0,C.jsx)("thead",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{style:{maxWidth:"60px"}}),(0,C.jsx)("th",{children:"Schedule name"}),(0,C.jsx)("th",{style:{width:"150px"},children:"Schedule"}),(0,C.jsx)("th",{style:{width:"100px"},children:"Last tick"}),(0,C.jsx)("th",{children:"Last run"}),(0,C.jsx)("th",{children:"Partition set status"})]})}),(0,C.jsx)("tbody",{children:n.map((function(e){return(0,C.jsx)(gn,{scheduleState:e},e.id)}))})]})]}):null},fn=function(){return(0,C.jsx)(Qe.b,{intent:"warning",title:(0,C.jsxs)("div",{children:["Note: You can turn off any of the following sensors, but you cannot turn them back on."," "]}),description:(0,C.jsx)("div",{children:"The following sensors were previously started but now cannot be loaded. They may be part of a different workspace or from a sensor or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can\u2019t be loaded."})})},xn=function(){return(0,C.jsx)(Qe.b,{intent:"warning",title:(0,C.jsx)("div",{children:"Note: You can turn off any of the following schedules, but you cannot turn them back on."}),description:(0,C.jsx)("div",{children:"The following schedules were previously started but now cannot be loaded. They may be part of a different workspace or from a schedule or code location that no longer exists in code. You can turn them off, but you cannot turn them back on since they can\u2019t be loaded."})})},mn=function(e){var n=e.sensorState,t=n.id,r=n.selectorId,o=n.name,i=n.status,s=n.ticks,a=n.hasStopPermission,l=(0,nn.D)(cn.Xu,{onCompleted:cn.oI}),c=(0,F.Z)(l,2),d=c[0],u=c[1].loading,h=(0,on.p)(),p=function(){var e=(0,Xe.Z)(en().mark((function e(){return en().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i!==Y.ynu.RUNNING){e.next=4;break}return e.next=3,h({title:"Are you sure you want to turn off this sensor?",description:"The definition for this sensor is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."});case 3:d({variables:{jobOriginId:t,jobSelectorId:r}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=i===Y.ynu.RUNNING&&!a,x=s.length?s[0]:null;return(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{width:60},children:function(){var e=(0,C.jsx)(tn.X,{format:"switch",disabled:u||i===Y.ynu.STOPPED||f,checked:i===Y.ynu.RUNNING,onChange:p});return f?(0,C.jsx)(Oe.u,{content:sn.Qr,children:e}):e}()}),(0,C.jsxs)("td",{children:[(0,C.jsx)(rn.Z,{direction:"row",spacing:8,alignItems:"center",children:o}),(0,C.jsx)(dn.Y,{instigatorState:n})]}),(0,C.jsx)("td",{children:x?(0,C.jsx)(un.TW,{tick:x,instigationType:Y._5b.SENSOR}):(0,C.jsx)("span",{style:{color:U.w.Gray300},children:"None"})}),(0,C.jsx)("td",{children:(0,C.jsx)("div",{style:{display:"flex"},children:(0,C.jsx)(He.UD,{instigationState:n})})})]},o)},gn=function(e){var n=e.scheduleState,t=(0,nn.D)(an.d0,{onCompleted:an.JH}),r=(0,F.Z)(t,2),o=r[0],i=r[1].loading,s=(0,on.p)(),a=n.id,l=n.selectorId,c=n.name,d=n.ticks,u=n.status,h=n.typeSpecificData,p=d.length>0?d[0]:null,f=h&&"ScheduleData"===h.__typename?h.cronSchedule:null,x=function(){var e=(0,Xe.Z)(en().mark((function e(){return en().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u!==Y.ynu.RUNNING){e.next=4;break}return e.next=3,s({title:"Are you sure you want to stop this schedule?",description:"The definition for this schedule is not available. If you turn it off, you will not be able to turn it back on from the currently loaded workspace."});case 3:o({variables:{scheduleOriginId:a,scheduleSelectorId:l}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=u===Y.ynu.RUNNING&&!n.hasStopPermission;return(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{style:{width:60},children:function(){var e=(0,C.jsx)(tn.X,{format:"switch",checked:u===Y.ynu.RUNNING,disabled:u!==Y.ynu.RUNNING||i||m,onChange:x});return m?(0,C.jsx)(Oe.u,{content:sn.Qr,children:e}):e}()}),(0,C.jsxs)("td",{children:[(0,C.jsx)(rn.Z,{direction:"row",spacing:8,alignItems:"center",children:(0,C.jsx)("div",{children:c})}),(0,C.jsx)(dn.Y,{instigatorState:n})]}),(0,C.jsx)("td",{style:{maxWidth:150},children:(0,C.jsx)("div",{style:{position:"relative",width:"100%",whiteSpace:"pre-wrap",display:"block"},children:f?(0,C.jsx)(Oe.u,{position:"bottom",content:f,children:(0,ln.A)(f)}):(0,C.jsx)("div",{children:"\u2014"})})}),(0,C.jsx)("td",{children:p?(0,C.jsx)(un.TW,{tick:p,instigationType:Y._5b.SCHEDULE}):null}),(0,C.jsx)("td",{children:(0,C.jsx)(He.UD,{instigationState:n})}),(0,C.jsx)("td",{children:(0,C.jsx)("div",{style:{display:"flex"},children:"\u2014"})})]},c)},jn=t(89324),vn=t(17233),yn=function(e){var n=e.repos,t=s.useRef(null),r=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Ae.Uz)(n)}))}),[n]),o=(0,Pe.N)(ze.y,r),i=o.expandedKeys,a=o.onToggle,l=o.onToggleAll,c=s.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.schedules;e.push({type:"header",repoAddress:t,scheduleCount:r.length});var o=(0,Ae.Uz)(t);i.includes(o)&&r.forEach((function(n){e.push({type:"schedule",repoAddress:t,name:n})}))})),e}),[n,i]),d=(0,Le.w)(n.map((function(e){return e.repoAddress.name}))),u=(0,Ne.useVirtualizer)({count:c.length,getScrollElement:function(){return t.current},estimateSize:function(e){var n=c[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(vn.o,{}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:t,children:(0,C.jsx)(Ie.Nh,{$totalHeight:h,children:p.map((function(e){var n=e.index,t=e.key,r=e.size,o=e.start,s=c[n];return"header"===s.type?(0,C.jsx)(Fe.vG,{repoAddress:s.repoAddress,height:r,start:o,onToggle:a,onToggleAll:l,expanded:i.includes((0,Ae.Uz)(s.repoAddress)),showLocation:d.has(s.repoAddress.name),rightElement:(0,C.jsx)(Oe.u,{content:1===s.scheduleCount?"1 schedule":"".concat(s.scheduleCount," schedules"),placement:"top",children:(0,C.jsx)(B.V,{children:s.scheduleCount})})},t):(0,C.jsx)(vn.i,{name:s.name,repoAddress:s.repoAddress,height:r,start:o},t)}))})})})]})},wn=function(){(0,w.Px)(),(0,b.j)("Overview | Schedules");var e=s.useContext(Ee.C5),n=e.allRepos,t=e.visibleRepos,r=n.length,o=(0,Se.q)({queryKey:"search",defaults:{search:""}}),i=(0,F.Z)(o,2),a=i[0],l=i[1],c=(0,d.a)(Cn,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,g=(0,y.C4)(c,y.dT),j=s.useMemo((function(){var e=Be(t);return Sn(u).filter((function(n){var t=n.repoAddress;return e.has((0,Ae.Uz)(t))}))}),[u,t]),v=a.trim().toLocaleLowerCase(),k=v.length>0,S=s.useMemo((function(){var e=v.toLocaleLowerCase();return j.map((function(n){return{repoAddress:n.repoAddress,schedules:n.schedules.filter((function(n){return n.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.schedules.length>0}))}),[j,v]);return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(p.m,{title:(0,C.jsx)(f.X6,{children:"Overview"}),tabs:(0,C.jsx)(E,{tab:"schedules",refreshState:g})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[r>0?(0,C.jsx)(Ce.C,{}):null,(0,C.jsx)(be.oi,{icon:"search",value:a,onChange:function(e){return l(e.target.value)},placeholder:"Filter by schedule name\u2026",style:{width:"340px"}})]}),h&&!r?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):(0,C.jsxs)(C.Fragment,{children:["InstigationStates"===(null===u||void 0===u?void 0:u.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(bn,{count:u.unloadableInstigationStatesOrError.results.length}):null,(0,C.jsx)(jn.K,{daemonHealth:null===u||void 0===u?void 0:u.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray}}),function(){if(h&&!u)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading schedules\u2026"})]})});var e=n.length>t.length;return S.length?(0,C.jsx)(yn,{repos:S}):k?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No matching schedules",description:e?(0,C.jsxs)("div",{children:["No schedules matching ",(0,C.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No schedules matching ",(0,C.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No schedules",description:e?"No schedules were found in the selected code locations":"No schedules were found in your definitions"})})}()]})]})},bn=function(e){var n=e.count,t=s.useState(!1),r=(0,F.Z)(t,2),o=r[0],i=r[1];if(!n)return null;var a=1===n?"1 unloadable schedule":"".concat(n," unloadable schedules");return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray},children:(0,C.jsx)(Qe.b,{intent:"warning",title:a,description:(0,C.jsxs)(x.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,C.jsx)("div",{children:"Schedules were previously started but now cannot be loaded. They may be part of a code locations that no longer exist. You can turn them off, but you cannot turn them back on."}),(0,C.jsx)(V.zx,{onClick:function(){return i(!0)},children:1===n?"View unloadable schedule":"View unloadable schedules"})]})})}),(0,C.jsxs)(q.Vq,{isOpen:o,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,C.jsx)(x.x,{padding:{bottom:8},children:(0,C.jsx)(kn,{})}),(0,C.jsx)(q.cN,{children:(0,C.jsx)(V.zx,{intent:"primary",onClick:function(){return i(!1)},children:"Done"})})]})]})},kn=function(){var e=(0,d.a)(En).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(pn,{scheduleStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,C.jsx)(v.T,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,C.jsx)(Z.$,{purpose:"section"})},Sn=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],o=(0,we.Z)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var s,a=(0,we.Z)(i.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.schedules,u=(0,Te.kQ)(c,i.name),h=d.map((function(e){return e.name}));h.length>0&&r.push({repoAddress:u,schedules:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){o.e(p)}finally{o.f()}return Ue(r)},Cn=(0,u.Ps)(de||(de=(0,l.Z)(["\n  query OverviewSchedulesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                schedules {\n                  id\n                  name\n                  description\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n"])),j.B,I.O),En=(0,u.Ps)(ue||(ue=(0,l.Z)(["\n  query UnloadableSchedulesQuery {\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),He.ai,j.B),Tn=t(57466),An=t(19377),On=function(e){var n=e.repos,t=s.useRef(null),r=s.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,Ae.Uz)(n)}))}),[n]),o=(0,Pe.N)(ze.y,r),i=o.expandedKeys,a=o.onToggle,l=o.onToggleAll,c=s.useMemo((function(){var e=[];return n.forEach((function(n){var t=n.repoAddress,r=n.sensors;e.push({type:"header",repoAddress:t,sensorCount:r.length});var o=(0,Ae.Uz)(t);i.includes(o)&&r.forEach((function(n){e.push({type:"sensor",repoAddress:t,name:n})}))})),e}),[n,i]),d=(0,Le.w)(n.map((function(e){return e.repoAddress.name}))),u=(0,Ne.useVirtualizer)({count:c.length,getScrollElement:function(){return t.current},estimateSize:function(e){var n=c[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(An.K,{}),(0,C.jsx)("div",{style:{overflow:"hidden"},children:(0,C.jsx)(Ie.W2,{ref:t,children:(0,C.jsx)(Ie.Nh,{$totalHeight:h,children:p.map((function(e){var n=e.index,t=e.key,r=e.size,o=e.start,s=c[n];return"header"===s.type?(0,C.jsx)(Fe.vG,{repoAddress:s.repoAddress,height:r,start:o,onToggle:a,onToggleAll:l,expanded:i.includes((0,Ae.Uz)(s.repoAddress)),showLocation:d.has(s.repoAddress.name),rightElement:(0,C.jsx)(Oe.u,{content:1===s.sensorCount?"1 sensor":"".concat(s.sensorCount," sensors"),placement:"top",children:(0,C.jsx)(B.V,{children:s.sensorCount})})},t):(0,C.jsx)(An.R,{name:s.name,repoAddress:s.repoAddress,height:r,start:o},t)}))})})})]})},Nn=function(){(0,w.Px)(),(0,b.j)("Overview | Sensors");var e=s.useContext(Ee.C5),n=e.allRepos,t=e.visibleRepos,r=n.length,o=(0,Se.q)({queryKey:"search",defaults:{search:""}}),i=(0,F.Z)(o,2),a=i[0],l=i[1],c=(0,d.a)(Rn,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),u=c.data,h=c.loading,g=(0,y.C4)(c,y.dT),j=s.useMemo((function(){var e=Be(t);return Pn(u).filter((function(n){var t=n.repoAddress;return e.has((0,Ae.Uz)(t))}))}),[u,t]),v=a.trim().toLocaleLowerCase(),k=v.length>0,S=s.useMemo((function(){var e=v.toLocaleLowerCase();return j.map((function(n){return{repoAddress:n.repoAddress,sensors:n.sensors.filter((function(n){return n.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.sensors.length>0}))}),[j,v]);return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(p.m,{title:(0,C.jsx)(f.X6,{children:"Overview"}),tabs:(0,C.jsx)(E,{tab:"sensors",refreshState:g})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[r>0?(0,C.jsx)(Ce.C,{}):null,(0,C.jsx)(be.oi,{icon:"search",value:a,onChange:function(e){return l(e.target.value)},placeholder:"Filter by sensor name\u2026",style:{width:"340px"}})]}),h&&!r?(0,C.jsx)(x.x,{padding:64,children:(0,C.jsx)(Z.$,{purpose:"page"})}):(0,C.jsxs)(C.Fragment,{children:["InstigationStates"===(null===u||void 0===u?void 0:u.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(In,{count:u.unloadableInstigationStatesOrError.results.length}):null,(0,C.jsx)(Tn.F,{daemonHealth:null===u||void 0===u?void 0:u.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray}}),function(){if(h&&!u)return(0,C.jsx)(x.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,C.jsx)(Z.$,{purpose:"body-text"}),(0,C.jsx)("div",{style:{color:U.w.Gray600},children:"Loading sensors\u2026"})]})});var e=n.length>t.length;return S.length?(0,C.jsx)(On,{repos:S}):k?(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No matching sensors",description:e?(0,C.jsxs)("div",{children:["No sensors matching ",(0,C.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,C.jsxs)("div",{children:["No sensors matching ",(0,C.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,C.jsx)(x.x,{padding:{top:20},children:(0,C.jsx)(m.t,{icon:"search",title:"No sensors",description:e?"No sensors were found in the selected code locations":"No sensors were found in your definitions"})})}()]})]})},In=function(e){var n=e.count,t=s.useState(!1),r=(0,F.Z)(t,2),o=r[0],i=r[1];if(!n)return null;var a=1===n?"1 unloadable sensor":"".concat(n," unloadable sensors");return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:U.w.KeylineGray},children:(0,C.jsx)(Qe.b,{intent:"warning",title:a,description:(0,C.jsxs)(x.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,C.jsx)("div",{children:"Sensors were previously started but now cannot be loaded. They may be part of a code location that no longer exists. You can turn them off, but you cannot turn them back on."}),(0,C.jsx)(V.zx,{onClick:function(){return i(!0)},children:1===n?"View unloadable sensor":"View unloadable sensors"})]})})}),(0,C.jsxs)(q.Vq,{isOpen:o,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,C.jsx)(x.x,{padding:{bottom:8},children:(0,C.jsx)(Ln,{})}),(0,C.jsx)(q.cN,{children:(0,C.jsx)(V.zx,{intent:"primary",onClick:function(){return i(!1)},children:"Done"})})]})]})},Ln=function(){var e=(0,d.a)(Fn).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,C.jsx)(hn,{sensorStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,C.jsx)(v.T,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,C.jsx)(Z.$,{purpose:"section"})},Pn=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,t=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),r=[],o=(0,we.Z)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var s,a=(0,we.Z)(i.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.sensors,u=(0,Te.kQ)(c,i.name),h=d.map((function(e){return e.name}));h.length>0&&r.push({repoAddress:u,sensors:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){o.e(p)}finally{o.f()}return Ue(r)},Rn=(0,u.Ps)(he||(he=(0,l.Z)(["\n  query OverviewSensorsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                sensors {\n                  id\n                  name\n                  description\n                  sensorType\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n"])),j.B,I.O),Fn=(0,u.Ps)(pe||(pe=(0,l.Z)(["\n  query UnloadableSensorsQuery {\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),He.ai,j.B),zn=t(87011),Zn=t(32028),_n=t(52453),Un=t(76314),Bn=t(16798),Dn=(0,u.Ps)(fe||(fe=(0,l.Z)(["\n  fragment ScheduleFutureTicksFragment on Schedule {\n    id\n    executionTimezone\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(cursor: $tickCursor, until: $ticksUntil) {\n      results {\n        timestamp\n      }\n    }\n  }\n"]))),qn=t(25582),Vn=t(34653),Mn=t(55752),Wn=t(18499),$n=function(e,n){return"".concat(n,"-").concat((0,Ae.Uz)(e))},Gn=(0,u.Ps)(xe||(xe=(0,l.Z)(["\n  query RunTimelineQuery(\n    $inProgressFilter: RunsFilter!\n    $terminatedFilter: RunsFilter!\n    $tickCursor: Float\n    $ticksUntil: Float\n  ) {\n    unterminated: runsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    terminated: runsOrError(filter: $terminatedFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          name\n          loadStatus\n          displayMetadata {\n            key\n            value\n          }\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n                schedules {\n                  id\n                  name\n                  pipelineName\n                  scheduleState {\n                    id\n                    status\n                  }\n                  ...ScheduleFutureTicksFragment\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n"])),Mn.$X,Dn),Kn=36e5,Jn=function(e){switch(e){case"1":return Kn;case"6":return 216e5;case"12":return 432e5;case"24":return 864e5}},Qn=function(){(0,w.Px)(),(0,b.j)("Overview | Timeline");var e=s.useContext(Ee.C5),n=e.allRepos,t=e.visibleRepos,r=function(e){var n=s.useCallback((function(n){switch(n){case"1":case"6":case"12":case"24":return n;default:return e}}),[e]),t=(0,Un.U)("dagit.run-timeline-hour-window",n),r=(0,F.Z)(t,2),o=r[0],i=r[1],a=s.useCallback((function(n){i(n||e)}),[e,i]);return s.useMemo((function(){return[o,a]}),[o,a])}("12"),o=(0,F.Z)(r,2),i=o[0],a=o[1],l=s.useState((function(){return Date.now()})),u=(0,F.Z)(l,2),h=u[0],m=u[1],g=s.useState((function(){return 0})),j=(0,F.Z)(g,2),v=j[0],k=j[1],S=(0,Se.q)({queryKey:"search",defaults:{search:""}}),T=(0,F.Z)(S,2),A=T[0],O=T[1];s.useEffect((function(){m(Date.now());var e=setInterval((function(){m(Date.now())}),6e4);return function(){clearInterval(e)}}),[i]);var N=s.useCallback((function(){k((function(e){return e-Jn(i)}))}),[i]),I=s.useCallback((function(){k((function(e){return e+Jn(i)}))}),[i]),L=s.useCallback((function(){k(0)}),[]),P=s.useMemo((function(){return[h-Number(i)*Kn+v,h+36e5+v]}),[i,h,v]),R=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,F.Z)(e,2),r=t[0],o=t[1],i=r/1e3,a=o/1e3,l=(0,d.a)(Gn,{notifyOnNetworkStatusChange:!0,variables:{inProgressFilter:(0,c.Z)((0,c.Z)({},n),{},{statuses:[Y.VOA.CANCELING,Y.VOA.STARTED],createdBefore:a}),terminatedFilter:(0,c.Z)((0,c.Z)({},n),{},{statuses:Array.from(Vn.cv),createdBefore:a,updatedAfter:i}),tickCursor:i,ticksUntil:a}}),u=l.data,h=l.previousData,p=l.loading&&!u,f=u||h||{},x=f.unterminated,m=f.terminated,g=f.workspaceOrError,j=s.useMemo((function(){var e={},n=Date.now();return[].concat((0,_e.Z)("Runs"===(null===x||void 0===x?void 0:x.__typename)?x.results:[]),(0,_e.Z)("Runs"===(null===m||void 0===m?void 0:m.__typename)?m.results:[])).forEach((function(t){if(t.startTime&&t.repositoryOrigin&&(0,Wn.a)({start:r,end:o},{start:1e3*t.startTime,end:t.endTime?1e3*t.endTime:n})){var i=$n({name:t.repositoryOrigin.repositoryName,location:t.repositoryOrigin.repositoryLocationName},t.pipelineName);e[i]=[].concat((0,_e.Z)(e[i]||[]),[{id:t.id,status:t.status,startTime:1e3*t.startTime,endTime:t.endTime?1e3*t.endTime:n}])}})),e}),[o,x,m,r]),v=s.useMemo((function(){if(!g||"Workspace"!==g.__typename)return[];var e,n=[],t=(0,we.Z)(g.locationEntries);try{var i=function(){var t,i=e.value;if("WorkspaceLocationEntry"!==i.__typename||"RepositoryLocation"!==(null===(t=i.locationOrLoadError)||void 0===t?void 0:t.__typename))return"continue";var s,a=Date.now(),l=(0,we.Z)(i.locationOrLoadError.repositories);try{for(l.s();!(s=l.n()).done;){var c,d=s.value,u=(0,Te.kQ)(d.name,i.locationOrLoadError.name),h=(0,we.Z)(d.pipelines);try{var p=function(){var e,t=c.value,i=(d.schedules||[]).filter((function(e){return e.pipelineName===t.name})),s=[],l=(0,we.Z)(i);try{var h=function(){var n=e.value;n.scheduleState.status===Y.ynu.RUNNING&&n.futureTicks.results.forEach((function(e){var t=e.timestamp,i=1e3*t;i>a&&(0,Wn.a)({start:r,end:o},{start:i,end:i})&&s.push({id:"".concat(n.pipelineName,"-future-run-").concat(t),status:"SCHEDULED",startTime:i,endTime:i+5e3})}))};for(l.s();!(e=l.n()).done;)h()}catch(w){l.e(w)}finally{l.f()}var p=(0,ke.pv)(t.name),f=$n(u,t.name),x=p?"Ad hoc materializations":t.name,m=j[f]||[];if(!s.length&&!m.length)return"continue";var g=[].concat((0,_e.Z)(m),s);if(p){var v,y=n.find((function(e){return"asset"===e.jobType}));if(y)return(v=y.runs).push.apply(v,(0,_e.Z)(g)),"continue"}n.push({key:f,jobName:x,jobType:p?"asset":"job",repoAddress:u,path:(0,qn.jT)({repoName:u.name,repoLocation:u.location,pipelineName:t.name,isJob:t.isJob}),runs:[].concat((0,_e.Z)(m),s)})};for(h.s();!(c=h.n()).done;)p()}catch(f){h.e(f)}finally{h.f()}}}catch(f){l.e(f)}finally{l.f()}};for(t.s();!(e=t.n()).done;)i()}catch(a){t.e(a)}finally{t.f()}var s=n.reduce((function(e,n){var t=n.runs.map((function(e){return e.startTime}));return(0,c.Z)((0,c.Z)({},e),{},(0,Bn.Z)({},n.key,Math.min.apply(Math,(0,_e.Z)(t))))}),{});return n.sort((function(e,n){return s[e.key]-s[n.key]}))}),[g,j,r,o]);return s.useMemo((function(){return{jobs:v,initialLoading:p,queryData:l}}),[p,v,l])}(P),z=R.jobs,Z=R.initialLoading,_=R.queryData,U=(0,y.C4)(_,y.dT),B=s.useMemo((function(){var e=A.toLocaleLowerCase().trim(),n=t.flatMap((function(n){var t=(0,Te.kQ)(n.repository.name,n.repositoryLocation.name);return n.repository.pipelines.filter((function(n){return n.name.toLocaleLowerCase().includes(e)})).map((function(e){return $n(t,e.name)}))}));return new Set(n)}),[t,A]),D=s.useMemo((function(){return z.filter((function(e){var n=e.key;return B.has(n)}))}),[z,B]);return(0,C.jsxs)(x.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,C.jsx)(p.m,{title:(0,C.jsx)(f.X6,{children:"Overview"}),tabs:(0,C.jsx)(E,{tab:"timeline",refreshState:U})}),(0,C.jsxs)(x.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",justifyContent:"space-between"},children:[(0,C.jsxs)(x.x,{flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[n.length>1&&(0,C.jsx)(Ce.C,{}),(0,C.jsx)(be.oi,{icon:"search",value:A,onChange:function(e){return O(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"200px"}})]}),(0,C.jsxs)(x.x,{flex:{direction:"row",gap:16,alignItems:"center"},children:[(0,C.jsx)(zn.h,{activeItems:new Set([i]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:function(e){return a(e)}}),(0,C.jsxs)(x.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,C.jsx)(V.zx,{onClick:N,children:"\u2190"}),(0,C.jsx)(V.zx,{onClick:L,children:"Now"}),(0,C.jsx)(V.zx,{onClick:I,children:"\u2192"})]})]})]}),(0,C.jsx)(Zn.S,{region:"timeline",children:(0,C.jsx)(_n.q,{loading:Z,range:P,jobs:D})})]})},Hn=function(){return(0,C.jsxs)(a.rs,{children:[(0,C.jsx)(a.AW,{path:"/overview/timeline",children:(0,C.jsx)(Qn,{})}),(0,C.jsx)(a.AW,{path:"/overview/jobs",children:(0,C.jsx)(De,{})}),(0,C.jsx)(a.AW,{path:"/overview/schedules",children:(0,C.jsx)(wn,{})}),(0,C.jsx)(a.AW,{path:"/overview/sensors",children:(0,C.jsx)(Nn,{})}),(0,C.jsx)(a.AW,{path:"/overview/backfills/:backfillId",children:(0,C.jsx)(oe,{})}),(0,C.jsx)(a.AW,{path:"/overview/backfills",exact:!0,children:(0,C.jsx)(L,{})}),(0,C.jsx)(a.AW,{path:"/overview/resources",children:(0,C.jsx)(Ge,{})}),(0,C.jsx)(a.AW,{path:"*",render:function(){return(0,C.jsx)(a.l_,{to:"/overview/timeline"})}})]})},Xn=Hn},25298:function(e,n,t){t.d(n,{V:function(){return o},J:function(){return i}});var r=new Intl.NumberFormat(navigator.language,{compactDisplay:"short",notation:"compact"}),o=new Intl.NumberFormat(navigator.language,{}),i=function(e){return r.format(e)}}}]);
//# sourceMappingURL=4.e98b682f.chunk.js.map